<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8"/>
	<title>Instructions for Building the OpenBSD Port of Tor Browser</title>
	<link type="text/css" rel="stylesheet" href="torbsd.css"/>
	<meta name="author" content="gman999"/>
	<meta name="date" content="20150509"/>
	<meta name="note" content="above is markdown data, edit or leave alone."/>
</head>
<body>

<h1 id="buildingthedevelopmentversionoftheopenbsdtorbrowserport">Building the Development Version of the OpenBSD Tor Browser Port</h1>

<p>amd64/snapshots only?</p>

<p>These instructions are aimed at an audience interested in building the OpenBSD Tor Browser for the desktop/laptop client computer. For those interested in more comprehensive testings, buildings packages, etc., please refer to our [OpenBSD Build Box piece](obsd-buildbox.html].</p>

<p>As there is currently no binary, pre-built package available, it is necessary to compile the Tor Browser from source. Depending on hardware specifications, this will take a while.</p>

<p>Skipping any of these steps will likely result in failure. And since the port is in development and has a lot of moving parts, it may just break anyways.</p>

<h2 id="preparations">Preparations</h2>

<ul>
<li><p>Install OpenBSD ports tree into the default /usr/ports location as <a href="http://www.openbsd.org/anoncvs.html">per the FAQ instructions</a> on a recent snapshot of OpenBSD</p></li>
<li><p>As the OpenBSD ports tree will need to current and regularly update, add the appropriate remote CVS root to ~/.profile: &#8220;export CVSROOT=anoncvs@&#8230;:/cvs&#8221;</p></li>
<li><p>Create a &#8220;mystuff&#8221; directory at /usr/ports/mystuff where the Git repository will be located: &#8220;mkdir -p /usr/ports/mystuff&#8221;</p></li>
<li><p>Create a &#8220;pobj&#8221; which OpenBSD uses to compile ports: &#8220;mkdir -p /usr/ports/pobj&#8221;, which we will later add as a tmpfs mount</p></li>
<li><p>To ease cloning the Git repository, change the permissions on /usr/ports/mystuff with &#8220;chown -R <em>your user</em> /usr/ports/mystuff&#8221;</p></li>
<li><p>Firefox and the associated dependencies can employ a lot of disk space when compiling from source. The main directory to be concerned with is /usr/ports/pobj. With sufficient RAM, a shortcut to bypass filling the /usr/ports/pobj partition is to use mount_tmpfs(8). Type &#8220;mount -t tmpfs tmpfs /usr/ports/&#8221;s which will produce a large tmpfs mount.</p></li>
<li><p>To maintain a tmpfs mount after reboots for /usr/ports/pobj, add the following line to the /etc/fstab file: &#8220;swap /usr/ports/pobj tmpfs rw 0 0&#8221;</p></li>
</ul>

<p>Once mounted, a df(1) output might look something like this:</p>

<p>tmpfs 20931536 3232176 17699360 15% /usr/ports/pobj</p>

<h2 id="cloningthegitrepository">Cloning the Git Repository</h2>

<ul>
<li><p>Note that git(1) commands can be run over Tor with torsocks(1) which can be installed from packages or /usr/ports/net/torsocks.</p></li>
<li><p>To add a copy of the OpenBSD Tor Browser repository to /usr/ports/mystuff, type &#8220;git clone git://github.com/torbsd/openbsd-ports /usr/ports/mystuff&#8221;</p></li>
<li><p>Confirm that /usr/ports/mystuff/www/tbb is populated.</p></li>
</ul>

<h2 id="installingtorbrowser">Installing Tor Browser</h2>

<ul>
<li><p>From /usr/ports/mystuff/www/tbb/tor-browser, run &#8220;make install&#8221;</p></li>
<li><p>Alternately, to get a measure of the time to build the port, run &#8220;time make install&#8221;</p></li>
</ul>

<h2 id="updatingtheport">Updating the Port</h2>

<ul>
<li><p>To update the local copy from the Git repository, run &#8220;cd /usr/ports/mystuff &amp;&amp; git pull&#8221;</p></li>
<li><p>To update the ports tree, &#8220;cd /usr &amp;&amp; cvs up -Pd&#8221;</p></li>
</ul>

<p>?? make -j on OBSD?
<code>last updated: Mon May 11 18:14:25 2015 -0400</code></p>

</body>
</html>
